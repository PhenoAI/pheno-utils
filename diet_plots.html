<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Diet logging plots – pheno-utils</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-c16f70d9e6245094a6412faf456d4b9c.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="Diet logging plots – pheno-utils">
<meta property="og:description" content="Pheno data utils - viz, loaders, mergers">
<meta property="og:image" content="https://phenoai.github.io/pheno-utils/16_diet_plots_files/figure-html/cell-13-output-1.png">
<meta property="og:site_name" content="pheno-utils">
<meta property="og:image:height" content="1307">
<meta property="og:image:width" content="1559">
<meta name="twitter:title" content="Diet logging plots – pheno-utils">
<meta name="twitter:description" content="Pheno data utils - viz, loaders, mergers">
<meta name="twitter:image" content="https://phenoai.github.io/pheno-utils/16_diet_plots_files/figure-html/cell-13-output-1.png">
<meta name="twitter:image-height" content="1307">
<meta name="twitter:image-width" content="1559">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">pheno-utils</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./basic_plots.html">Plots</a></li><li class="breadcrumb-item"><a href="./diet_plots.html">Diet logging plots</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">pheno-utils</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Data Loaders</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pheno_loader.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pheno loader</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./meta_loader.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Metadata loader</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cohort_selector.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Cohort selector</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Plots</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./basic_plots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Basic plots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./blandaltman_plots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bland-Altman plots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./age_reference_plots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Age reference plots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./timeseries_plots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Time series plots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./date_plots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dates plots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sleep_plots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Sleep plots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./diet_plots.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Diet logging plots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cgm_plots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">CGM plots</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./basic_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Basic analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ecg_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ECG analysis</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Other</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./config.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Config</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#draw_pie_chart" id="toc-draw_pie_chart" class="nav-link active" data-scroll-target="#draw_pie_chart">draw_pie_chart</a></li>
  <li><a href="#extract_units" id="toc-extract_units" class="nav-link" data-scroll-target="#extract_units">extract_units</a></li>
  <li><a href="#prepare_meals" id="toc-prepare_meals" class="nav-link" data-scroll-target="#prepare_meals">prepare_meals</a></li>
  <li><a href="#plot_nutrient_lollipop" id="toc-plot_nutrient_lollipop" class="nav-link" data-scroll-target="#plot_nutrient_lollipop">plot_nutrient_lollipop</a></li>
  <li><a href="#plot_nutrient_bars" id="toc-plot_nutrient_bars" class="nav-link" data-scroll-target="#plot_nutrient_bars">plot_nutrient_bars</a></li>
  <li><a href="#add_size_legend" id="toc-add_size_legend" class="nav-link" data-scroll-target="#add_size_legend">add_size_legend</a></li>
  <li><a href="#plot_meals_hbars" id="toc-plot_meals_hbars" class="nav-link" data-scroll-target="#plot_meals_hbars">plot_meals_hbars</a></li>
  <li><a href="#plot_diet_cgm_sleep" id="toc-plot_diet_cgm_sleep" class="nav-link" data-scroll-target="#plot_diet_cgm_sleep">plot_diet_cgm_sleep</a></li>
  <li><a href="#how-to-plot-diet-logs" id="toc-how-to-plot-diet-logs" class="nav-link" data-scroll-target="#how-to-plot-diet-logs">How to plot diet logs</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/phenoai/pheno-utils/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./basic_plots.html">Plots</a></li><li class="breadcrumb-item"><a href="./diet_plots.html">Diet logging plots</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Diet logging plots</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->
<hr>
<p><a href="https://github.com/phenoai/pheno-utils/blob/main/pheno_utils/diet_plots.py#L371" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="draw_pie_chart" class="level3">
<h3 class="anchored" data-anchor-id="draw_pie_chart">draw_pie_chart</h3>
<blockquote class="blockquote">
<pre><code> draw_pie_chart (ax:matplotlib.axes._axes.Axes, x:float, y:float,
                 data:List[float], size:float, palette:str='muted',
                 alpha:float=0.7)</code></pre>
</blockquote>
<p>*Draw a pie chart as an inset (in absolute figure coordinates) within the given axes at the specified data coordinates. What this solves is the issue of y-axis and x-axis scaling being different, which distorts the pie chart when drawn directly on the axes.</p>
<p>Args:</p>
<pre><code>ax (plt.Axes): The axis on which to draw the pie chart.
x (float): The x-coordinate in data coordinates where the pie chart's center will be placed.
y (float): The y-coordinate in data coordinates where the pie chart's center will be placed.
data (List[float]): The data values to be represented in the pie chart.
size (float): The size (radius) of the pie chart in axes-relative coordinates.
palette (str): The color palette to use for the pie slices.</code></pre>
<p>Returns:</p>
<pre><code>List[plt.Patch]: A list of wedge objects representing the pie chart slices.*</code></pre>
<hr>
<p><a href="https://github.com/phenoai/pheno-utils/blob/main/pheno_utils/diet_plots.py#L360" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="extract_units" class="level3">
<h3 class="anchored" data-anchor-id="extract_units">extract_units</h3>
<blockquote class="blockquote">
<pre><code> extract_units (column_names:List[str])</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/phenoai/pheno-utils/blob/main/pheno_utils/diet_plots.py#L277" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="prepare_meals" class="level3">
<h3 class="anchored" data-anchor-id="prepare_meals">prepare_meals</h3>
<blockquote class="blockquote">
<pre><code> prepare_meals (diet_log:pandas.core.frame.DataFrame,
                participant_id:int=None, array_index:int=None,
                time_range:Tuple[str,str]=None,
                label:str='short_food_name', return_meals:bool=True,
                return_summary:bool=False, y_include:List[str]=None,
                y_exclude:List[str]=None, agg_units:dict={'kcal': 'sum',
                'g': 'sum', 'mg': 'sum', 'unknown': 'first'},
                x_col:str='collection_timestamp')</code></pre>
</blockquote>
<p>*Prepare the diet log data for plotting meals and/or daily summaries.</p>
<p>Args:</p>
<pre><code>diet_log (pd.DataFrame): The dataframe containing the diet log data, with columns for timestamps, nutrients, and other measurements.
participant_id (Optional[int]): The participant's ID to filter the diet log. If None, no filtering is done. Default is None.
array_index (Optional[int]): The array index to filter the diet log. If None, no filtering is done. Default is None.
time_range (Optional[Tuple[str, str]]): A tuple of strings representing the start and end dates for filtering the data. Format should be 'YYYY-MM-DD'. Default is None.
label (str): The name of the column in `diet_log` representing the labels for each meal. Default is 'short_food_name'.
return_meals (bool): If True, includes individual meals in the plot. Default is True.
return_summary (bool): If True, includes a daily summary in the plot. Default is False.
y_include (List[str]): A list of nutrients (regex) to include in the plot. Default is None.
y_exclude (List[str]): A list of nutrients (regex) to exclude from the plot. Default is None.
agg_units (dict): A dictionary mapping nutrient units to aggregation functions.
x_col (str): The name of the column in `diet_log` representing the x-axis variable, such as timestamps. Default is 'collection_timestamp'.</code></pre>
<p>Returns:</p>
<pre><code>pd.DataFrame: A dataframe containing the prepared data for plotting.*</code></pre>
<hr>
<p><a href="https://github.com/phenoai/pheno-utils/blob/main/pheno_utils/diet_plots.py#L133" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="plot_nutrient_lollipop" class="level3">
<h3 class="anchored" data-anchor-id="plot_nutrient_lollipop">plot_nutrient_lollipop</h3>
<blockquote class="blockquote">
<pre><code> plot_nutrient_lollipop (diet_log:pandas.core.frame.DataFrame,
                         x:str='collection_timestamp',
                         y:str='calories_kcal', size:str='total_g',
                         label:str='short_food_name',
                         participant_id:int=None, array_index:int=None,
                         time_range:Tuple[str,str]=None, meals:bool=True,
                         summary:bool=False, nut_include:List[str]=None,
                         nut_exclude:List[str]=None, legend:bool=True,
                         size_scale:float=5, palette:str='muted',
                         alpha:float=0.7,
                         ax:matplotlib.axes._axes.Axes=None,
                         figsize:Tuple[float,float]=(12, 3))</code></pre>
</blockquote>
<p>*Plot a lollipop chart with pie charts representing nutrient composition for each meal.</p>
<p>NOTE: The y-axis is scaled to match the units of the x-axis, to avoid distortion of the pie charts. Due to scaling, if you intend to change <code>xlim</code> after plotting, you must also provide <code>date_range</code>. Use the <code>second_y</code> of g.plot() option to plot it with other y-axis data.</p>
<p>Args:</p>
<pre><code>diet_log (pd.DataFrame): The dataframe containing the diet log data, with columns for timestamps, nutrients, and other measurements.
x (str): The name of the column in `diet_log` representing the x-axis variable, such as timestamps. Default is 'collection_timestamp'.
y (str): The name of the column in `diet_log` representing the y-axis variable, such as calories. Default is 'calories_kcal'.
size (str): The name of the column in `diet_log` representing the size of the pie charts. Default is 'total_g'.
label (str): The name of the column in `diet_log` representing the labels for each meal. Default is 'short_food_name'.
participant_id (Optional[int]): The participant's ID to filter the diet log. If None, no filtering is done. Default is None.
time_range (Optional[Tuple[str, str]]): A tuple of strings representing the start and end dates for filtering the data. Format should be 'YYYY-MM-DD'. Default is None.
meals (bool): If True, includes individual meals in the plot. Default is True.
summary (bool): If True, includes a daily summary in the plot. Default is False.
nut_include (List[str]): A list of nutrients to include in the plot. Default is None.
nut_exclude (List[str]): A list of nutrients to exclude from the plot. Default is None.
legend (bool): If True, includes a legend in the plot. Default is True.
size_scale (float): The scaling factor for the size of the pie charts. Default is 5.
palette (str): The color palette to use for the pie slices. Default is DEFAULT_PALETTTE.
alpha (float): The transparency of the pie slices. Default is 0.7.
ax (Optional[plt.Axes]): The Matplotlib axis on which to plot the lollipop chart. If None, a new axis is created. Default is None.
figsize (Tuple[float, float]): The size of the figure to create. Default is (12, 6).</code></pre>
<p>Returns:</p>
<pre><code>plt.Axes: The Matplotlib axis on which the chart was plotted.*</code></pre>
<hr>
<p><a href="https://github.com/phenoai/pheno-utils/blob/main/pheno_utils/diet_plots.py#L26" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="plot_nutrient_bars" class="level3">
<h3 class="anchored" data-anchor-id="plot_nutrient_bars">plot_nutrient_bars</h3>
<blockquote class="blockquote">
<pre><code> plot_nutrient_bars (diet_log:pandas.core.frame.DataFrame,
                     x:str='collection_timestamp',
                     label:str='short_food_name', participant_id:int=None,
                     array_index:int=None, time_range:Tuple[str,str]=None,
                     meals:bool=True, summary:bool=False,
                     nut_include:List[str]=None,
                     nut_exclude:List[str]=None, agg_units:dict={'kcal':
                     'sum', 'g': 'sum', 'mg': 'sum'}, legend:bool=True,
                     bar_width=numpy.timedelta64(15,'m'),
                     palette:str='muted', alpha:float=0.7,
                     ax:matplotlib.axes._axes.Axes=None,
                     figsize:Tuple[float,float]=(14, 3))</code></pre>
</blockquote>
<p>*Plot a stacked bar chart representing nutrient intake for each meal over time.</p>
<p>Args:</p>
<pre><code>diet_log (pd.DataFrame): The dataframe containing the diet log data, with columns for timestamps, nutrients, and other measurements.
x (str): The name of the column in `diet_log` representing the x-axis variable, such as timestamps. Default is 'collection_timestamp'.
label (str): The name of the column in `diet_log` representing the labels for each meal. Default is 'short_food_name'.
participant_id (Optional[int]): The participant's ID to filter the diet log. If None, no filtering is done. Default is None.
array_index (Optional[int]): The array index to filter the diet log. If None, no filtering is done. Default is None.
time_range (Optional[Tuple[str, str]]): A tuple of strings representing the start and end dates for filtering the data. Format should be 'YYYY-MM-DD'. Default is None.
meals (bool): If True, includes individual meals in the plot. Default is True.
summary (bool): If True, includes a daily summary in the plot. Default is False.
nut_include (List[str]): A list of nutrients to include in the plot. Default is None.
nut_exclude (List[str]): A list of nutrients to exclude from the plot. Default is None.
agg_units (dict): A dictionary mapping nutrient units to aggregation functions. Only nutrients with units in this dictionary are plotted.
legend (bool): If True, includes a legend in the plot. Default is True.
bar_width (np.timedelta64): The width of the bars representing each meal on the time axis. Default is 15 minutes.
palette (str): The color palette to use for the stacked bars.
alpha (float): The transparency of the stacked bars. Default is 0.7.
ax (Optional[plt.Axes]): The Matplotlib axis on which to plot the bar chart. If None, a new axis is created. Default is None.
figsize (Tuple[float, float]): The size of the figure to create. Default is (14, 3).</code></pre>
<p>Returns:</p>
<pre><code>None: The function creates a stacked bar chart on the specified or newly created axis.*</code></pre>
<hr>
<p><a href="https://github.com/phenoai/pheno-utils/blob/main/pheno_utils/diet_plots.py#L508" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="add_size_legend" class="level3">
<h3 class="anchored" data-anchor-id="add_size_legend">add_size_legend</h3>
<blockquote class="blockquote">
<pre><code> add_size_legend (ax:matplotlib.axes._axes.Axes, sizes:List[int],
                  size_scale:float, alpha:float, shift:int=0)</code></pre>
</blockquote>
<p><em>Add a size legend to a plot_meals_hbars plot using broken_barh.</em></p>
<hr>
<p><a href="https://github.com/phenoai/pheno-utils/blob/main/pheno_utils/diet_plots.py#L431" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="plot_meals_hbars" class="level3">
<h3 class="anchored" data-anchor-id="plot_meals_hbars">plot_meals_hbars</h3>
<blockquote class="blockquote">
<pre><code> plot_meals_hbars (diet_log:pandas.core.frame.DataFrame,
                   x:str='collection_timestamp',
                   y:str='short_food_category', size:str='weight_g',
                   hue:str='short_food_category', participant_id:int=None,
                   array_index:int=None, time_range:Tuple[str,str]=None,
                   y_include:List[str]=None, y_exclude:List[str]=None,
                   rename_categories:dict={'beef, veal, lamb, and other
                   meat products': 'meat products', 'milk, cream cheese
                   and yogurts': 'milk products', 'nuts, seeds, and
                   products': 'nuts and seeds', 'eggs and their products':
                   'eggs', 'pulses and products': 'pulses', 'fruit juices
                   and soft drinks': 'juices and soft drinks', 'low
                   calories and diet drinks': 'low cal. drinks', 'poultry
                   and its products': 'poultry', 'pasta, grains and side
                   dishes': 'grains', 'industrialized vegetarian food
                   ready to eat': 'industrialized veg.'},
                   legend:bool=True, size_legend:List[int]=[100, 200,
                   500], size_scale:float=5, palette:str='muted',
                   alpha:float=0.7, ax:matplotlib.axes._axes.Axes=None,
                   figsize:Tuple[float,float]=(12, 6))</code></pre>
</blockquote>
<p>*Plot a diet chart with bars representing meals and their size over time.</p>
<p>Args:</p>
<pre><code>diet_log (pd.DataFrame): The dataframe containing the diet log data, with columns for timestamps, nutrients, and other measurements.
x (str): The name of the column in `diet_log` representing the x-axis variable, such as timestamps. Default is 'collection_timestamp'.
y (str): The name of the column in `diet_log` representing the y-axis variable, such as food categories. Default is 'short_food_category'.
size (str): The name of the column in `diet_log` representing the size of the bars. Default is 'weight_g'.
hue (str): The name of the column in `diet_log` representing the color of the bars. Default is 'short_food_category'.
participant_id (Optional[int]): The participant's ID to filter the diet log. If None, no filtering is done. Default is None.
time_range (Optional[Tuple[str, str]]): A tuple of strings representing the start and end dates for filtering the data. Format should be 'YYYY-MM-DD'. Default is None.
y_include (List[str]): A list of strings representing the categories to include in the plot. Default is None.
y_exclude (List[str]): A list of strings representing the categories to exclude from the plot. Default is None.
rename_categories (dict): A dictionary mapping original food categories to shorter names. Default is SHORT_FOOD_CATEGORIES.
legend (bool): If True, includes a legend in the plot. Default is True.
size_legend (List[int]): A list of integers representing the sizes to include in the size legend. Default is [100, 200, 500].
size_scale (float): The scaling factor for the size of the bars. Default is 5.
palette (str): The palette to use for the bars.
alpha (float): The transparency of the bars. Default is 0.7.
ax (Optional[plt.Axes]): The Matplotlib axis on which to plot the lollipop chart. If None, a new axis is created. Default is None.
figsize (Tuple[float, float]): The size of the figure to create. Default is (12, 6).</code></pre>
<p>Returns:</p>
<pre><code>plt.Axes: The Matplotlib axis on which the chart was plotted.*</code></pre>
<hr>
<p><a href="https://github.com/phenoai/pheno-utils/blob/main/pheno_utils/diet_plots.py#L552" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="plot_diet_cgm_sleep" class="level3">
<h3 class="anchored" data-anchor-id="plot_diet_cgm_sleep">plot_diet_cgm_sleep</h3>
<blockquote class="blockquote">
<pre><code> plot_diet_cgm_sleep (diet:pandas.core.frame.DataFrame=None,
                      cgm:pandas.core.frame.DataFrame=None,
                      sleep_events:pandas.core.frame.DataFrame=None,
                      sleep_channels:pandas.core.frame.DataFrame=None,
                      cgm_grid:List[int]=[0, 54, 70, 100, 140, 180],
                      channel_filter:List[str]=['heart_rate', 'actigraph',
                      'spo2'], participant_id=None, array_index=None,
                      time_range:Tuple[str,str]=None, figsize=(14, 10),
                      nutrient_kws:dict={}, meals_kws:dict={},
                      cgm_kws:dict={}, events_kws:dict={},
                      channels_kws:dict={})</code></pre>
</blockquote>
<p>*Plot diet, CGM and sleep data together.</p>
<p>Arg:</p>
<pre><code>diet (pd.DataFrame): Diet logging data. Set to None to remove from figure.
cgm (pd.DataFrame): CGM data. Set to None to remove from figure.
sleep_events (pd.DataFrame): Sleep events data. Set to None to remove from figure.
sleep_channels (pd.DataFrame): Sleep channels data. Set to None to remove from figure.
cgm_grid (List[int]): CGM grid lines. Default: [0, 54, 70, 100, 140, 180].
channel_filter (List[str]): Which sleep channels to include in the plot. Default: ['heart_rate', 'actigraph', 'spo2'].
participant_id (int): Participant ID.
array_index (int): Array index.
time_range (Tuple[str, str]): Time range to plot.
figsize (Tuple[int, int]): Figure size.
nutrient_kws (dict): Keyword arguments for diet nutrients lollipop plot.
meals_kws (dict): Keyword arguments for diet meals plot.
cgm_kws (dict): Keyword arguments for CGM plot.
events_kws (dict): Keyword arguments for sleep events plot.
channels_kws (dict): Keyword arguments for sleep channels plot.</code></pre>
<p>Returns:</p>
<pre><code>TimeSeriesFigure: The figure object containing the plots.*</code></pre>
</section>
<section id="how-to-plot-diet-logs" class="level1">
<h1>How to plot diet logs</h1>
<p>This module provides functions for plotting diet data, as well as a function for plotting diet, CGM and sleep data together.</p>
<p>First, we will load the time series data for diet, CGM and sleep. (See also the dedicated modules for sleep and CGM.)</p>
<div id="cell-12" class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pheno_utils <span class="im">import</span> PhenoLoader</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>pl <span class="op">=</span> PhenoLoader(<span class="st">'sleep'</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>channels_df <span class="op">=</span> pl.load_bulk_data(<span class="st">'channels_time_series'</span>)  <span class="co"># contains: heart_rate, spo2, respiratory_movement</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>events_df <span class="op">=</span> pl.load_bulk_data(<span class="st">'events_time_series'</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>diet_df <span class="op">=</span> PhenoLoader(<span class="st">'diet_logging'</span>).dfs[<span class="st">'diet_logging'</span>]</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>cgm_df <span class="op">=</span> PhenoLoader(<span class="st">'cgm'</span>).dfs[<span class="st">'cgm'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Warning: index is not unique for diet_logging</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/ec2-user/projects/pheno-utils/pheno_utils/pheno_loader.py:610: UserWarning: No date field found
  warnings.warn(f'No date field found')
/home/ec2-user/projects/pheno-utils/pheno_utils/pheno_loader.py:610: UserWarning: No date field found
  warnings.warn(f'No date field found')
/home/ec2-user/projects/pheno-utils/pheno_utils/pheno_loader.py:610: UserWarning: No date field found
  warnings.warn(f'No date field found')</code></pre>
</div>
</div>
<div id="cell-13" class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>diet_df.head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">short_food_name</th>
<th data-quarto-table-cell-role="th">food_category</th>
<th data-quarto-table-cell-role="th">weight_g</th>
<th data-quarto-table-cell-role="th">calories_kcal</th>
<th data-quarto-table-cell-role="th">carbohydrate_g</th>
<th data-quarto-table-cell-role="th">lipid_g</th>
<th data-quarto-table-cell-role="th">protein_g</th>
<th data-quarto-table-cell-role="th">sodium_mg</th>
<th data-quarto-table-cell-role="th">dietary_fiber_g</th>
<th data-quarto-table-cell-role="th">alcohol_g</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">participant_id</th>
<th data-quarto-table-cell-role="th">collection_timestamp</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">0</td>
<td data-quarto-table-cell-role="th">2020-06-21 16:06:00+03:00</td>
<td>Quinoa</td>
<td>Pasta, Grains and Side dishes_wholewheat</td>
<td>56.0</td>
<td>78.3104</td>
<td>12.1744</td>
<td>1.2992</td>
<td>2.8000</td>
<td>37.1504</td>
<td>1.4896</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2020-06-21 16:06:00+03:00</td>
<td>Hummus Salad</td>
<td>Pulses and products</td>
<td>80.0</td>
<td>215.2000</td>
<td>9.4400</td>
<td>16.8000</td>
<td>6.5600</td>
<td>377.6000</td>
<td>0.0000</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2020-06-21 16:06:00+03:00</td>
<td>Meatballs</td>
<td>Beef, veal, lamb, and other meat products</td>
<td>180.0</td>
<td>311.0940</td>
<td>16.1280</td>
<td>15.4440</td>
<td>24.7320</td>
<td>1164.5460</td>
<td>2.3904</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2020-06-21 19:28:00+03:00</td>
<td>Banana</td>
<td>Fruits</td>
<td>128.0</td>
<td>113.9200</td>
<td>25.9072</td>
<td>0.4224</td>
<td>1.3952</td>
<td>1.2800</td>
<td>3.3280</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2020-06-21 21:07:00+03:00</td>
<td>Bread</td>
<td>Bread</td>
<td>60.0</td>
<td>162.6000</td>
<td>28.3800</td>
<td>2.1000</td>
<td>5.2800</td>
<td>367.8000</td>
<td>1.6200</td>
<td>0.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-14" class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>cgm_df.head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">glucose</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">participant_id</th>
<th data-quarto-table-cell-role="th">collection_timestamp</th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">0</td>
<td data-quarto-table-cell-role="th">2020-06-22 00:14:00+03:00</td>
<td>106.2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2020-06-22 00:29:00+03:00</td>
<td>100.8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2020-06-22 00:44:00+03:00</td>
<td>97.2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2020-06-22 00:59:00+03:00</td>
<td>95.4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2020-06-22 01:14:00+03:00</td>
<td>93.6</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Next, we will use <a href="https://phenoai.github.io/pheno-utils/diet_plots.html#plot_diet_cgm_sleep"><code>plot_diet_cgm_sleep</code></a> to plot the data together.</p>
<div id="cell-16" class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>sns.set_style(<span class="st">'whitegrid'</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>plot_diet_cgm_sleep(diet_df, cgm_df, events_df, channels_df,</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>                    channel_filter<span class="op">=</span>[<span class="st">'heart_rate'</span>, <span class="st">'respiratory_movement'</span>, <span class="st">'spo2'</span>],</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>                    time_range<span class="op">=</span>(<span class="st">'2020-06-22 08:00'</span>, <span class="st">'2020-06-23 10:00'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="16_diet_plots_files/figure-html/cell-13-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Each of the types of diet plots can be plotted independently as well. We will use <a href="https://phenoai.github.io/pheno-utils/timeseries_plots.html#timeseriesfigure"><code>TimeSeriesFigure</code></a>, <a href="https://phenoai.github.io/pheno-utils/diet_plots.html#plot_nutrient_lollipop"><code>plot_nutrient_lollipop</code></a>, <a href="https://phenoai.github.io/pheno-utils/diet_plots.html#plot_meals_hbars"><code>plot_meals_hbars</code></a> and <a href="https://phenoai.github.io/pheno-utils/diet_plots.html#plot_nutrient_bars"><code>plot_nutrient_bars</code></a> to plot them together.</p>
<div id="cell-18" class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pheno_utils.timeseries_plots <span class="im">import</span> TimeSeriesFigure</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> TimeSeriesFigure(figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">7</span>))</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>time_range <span class="op">=</span> (<span class="st">'2020-06-22 06:00'</span>, <span class="st">'2020-06-23 15:00'</span>)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Each call to the plot() methods adds a new time-synced subplot to the figure</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>g.plot(plot_nutrient_lollipop, diet_df, size_scale<span class="op">=</span><span class="dv">15</span>,</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>       time_range<span class="op">=</span>time_range,</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>       name<span class="op">=</span><span class="st">'diet_pie'</span>)</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>g.plot(plot_meals_hbars, diet_df,</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>       time_range<span class="op">=</span>time_range,</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>       name<span class="op">=</span><span class="st">'diet_meals'</span>, height<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>g.plot(plot_nutrient_bars, diet_df,</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>       time_range<span class="op">=</span>time_range,</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>       label<span class="op">=</span><span class="va">None</span>, n_axes<span class="op">=</span><span class="dv">2</span>, nut_exclude<span class="op">=</span>[<span class="st">'sodium'</span>],</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>       name<span class="op">=</span><span class="st">'diet_bars'</span>)</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>g.set_axis_padding(<span class="fl">0.03</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="16_diet_plots_files/figure-html/cell-14-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/phenoai\.github\.io\/pheno-utils");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/phenoai/pheno-utils/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>